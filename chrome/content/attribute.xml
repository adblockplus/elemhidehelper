<?xml version="1.0"?>

<!-- This Source Code is subject to the terms of the Mozilla Public License
   - version 2.0 (the "License"). You can obtain a copy of the License at
   - http://mozilla.org/MPL/2.0/. -->

<bindings id="attributeBindings"
   xmlns="http://www.mozilla.org/xbl"
   xmlns:xul="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"
   xmlns:xbl="http://www.mozilla.org/xbl">

  <binding id="attributeBasic">
    <content>
      <xul:checkbox anonid="checkbox" xbl:inherits="checked,label"/>
    </content>
    <implementation>
      <property name="checked">
        <getter>
          return document.getAnonymousElementByAttribute(this, "anonid", "checkbox").checked;
        </getter>
      </property>
    </implementation>
    <handlers>
      <handler event="command" phase="bubble" action="toggleAttr(event.currentTarget);"/>
      <handler event="focus" phase="bubble" action="event.currentTarget.setAttribute('selected', 'true');"/>
      <handler event="blur" phase="bubble" action="event.currentTarget.removeAttribute('selected');"/>
    </handlers>
  </binding>

  <binding id="attributeAdvanced" extends="#attributeBasic">
    <content>
      <xul:checkbox anonid="checkbox" xbl:inherits="checked"/>
      <xul:vbox flex="1">
        <xul:label anonid="label" xbl:inherits="value=label" onclick="document.getAnonymousElementByAttribute(this.parentNode.parentNode, 'anonid', 'checkbox').click();"/>
        <xul:textbox anonid="textbox" xbl:inherits="value"/>
      </xul:vbox>
    </content>
    <implementation>
      <constructor>
        var randID = new String(Math.random()).replace(/\D/g, "");
        document.getAnonymousElementByAttribute(this, "anonid", "checkbox").setAttribute("id", randID);
        document.getAnonymousElementByAttribute(this, "anonid", "label").setAttribute("control", randID);
      </constructor>
      <property name="value">
        <getter>
          return document.getAnonymousElementByAttribute(this, "anonid", "textbox").value;
        </getter>
      </property>
    </implementation>
    <handlers>
      <handler event="input" phase="bubble" action="setSelectedAttrValue(event.currentTarget);"/>
    </handlers>
  </binding>
</bindings>
